<!DOCTYPE html>
<html>
  <head>
    <title>Scientific Programming</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.49.2" />
<title>Getting Started with Docker :: Scientific Programming</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/scientific-programming.github.io";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/containers/tutorial2/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="https://scientific-programming.github.io">Scientific Programming</a>
  
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/scientific-programming"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Github repo</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://gohugo.io/"  rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>Hugo Documentation</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/credits"  rel="noopener">
                  <i class='fa fa-bullhorn'></i> <label>Credits</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/introduction/" class="dd-item
        ">
      <div>
      <a href="/introduction/">Software Engineering in Science</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/containers/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/containers/">Containers</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/containers/tutorial1/" class="dd-item">
        <div>
          <a href="/containers/tutorial1/">
            Setting up the Software
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/containers/tutorial2/" class="dd-item active">
        <div>
          <a href="/containers/tutorial2/">
            Getting Started with Docker
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/containers/tutorial3/" class="dd-item">
        <div>
          <a href="/containers/tutorial3/">
            Saving and Sharing Images
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/version-control/" class="dd-item haschildren
        ">
      <div>
      <a href="/version-control/">Version Control</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/version-control/tutorial1/" class="dd-item">
        <div>
          <a href="/version-control/tutorial1/">
            Getting Started
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/version-control/tutorial2/" class="dd-item">
        <div>
          <a href="/version-control/tutorial2/">
            GitHub and Collaborating
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/version-control/tutorial3/" class="dd-item">
        <div>
          <a href="/version-control/tutorial3/">
            Discarding Temporary Changes
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/documentation/" class="dd-item haschildren
        ">
      <div>
      <a href="/documentation/">Documentation</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/documentation/generating-docs/" class="dd-item">
        <div>
          <a href="/documentation/generating-docs/">
            Documenting Code
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/documentation/generating-sphinx/" class="dd-item">
        <div>
          <a href="/documentation/generating-sphinx/">
            Generating documentation webpages with Sphinx
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/testing/" class="dd-item haschildren
        ">
      <div>
      <a href="/testing/">Testing Scientific Code</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/testing/simple-tests/" class="dd-item">
        <div>
          <a href="/testing/simple-tests/">
            Writing Simple Tests
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/testing/complex-tests/" class="dd-item">
        <div>
          <a href="/testing/complex-tests/">
            Writing More Complex Tests
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/testing/continuous-integration/" class="dd-item">
        <div>
          <a href="/testing/continuous-integration/">
            Continuous Integration
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/cheatsheet/" class="dd-item
        ">
      <div>
      <a href="/cheatsheet/">Command Cheatsheet</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/introduction/" >
   Software Engineering in Science</option>
    <option value="/containers/" >
   Containers</option> 
      <option value="/containers/tutorial1/" >- Setting up the Software</option>
      <option value="/containers/tutorial2/"  selected>- Getting Started with Docker</option>
      <option value="/containers/tutorial3/" >- Saving and Sharing Images</option>
  
    <option value="/version-control/" >
   Version Control</option>
    <option value="/documentation/" >
   Documentation</option>
    <option value="/testing/" >
   Testing Scientific Code</option>
    <option value="/cheatsheet/" >
   Command Cheatsheet</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/scientific-programming.github.io";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>Getting Started with Docker</h1>
    
    
    
    

<h3 id="first-steps">First Steps</h3>

<p>1) Make an account on the website <a href="https://hub.docker.com">https://hub.docker.com</a></p>

<p>Make the username something sensible as we&rsquo;ll have to use it soon!</p>

<p>1) If you haven&rsquo;t already, try &ldquo;docker run ubuntu:18.04&rdquo;. This downloads an image containing Ubuntu 18.04. If it it is the first time you have done this, you should see some output:</p>

<p><img src="../pulling-image.png" alt="Pulling an image" /></p>

<p>What is happening here? Have a look <a href="https://hub.docker.com/explore/">here</a>. Docker Hub is a centralised repository for storing container images, and many are provided for you as a basis for creating your own. So here, we&rsquo;re downloading the Ubuntu 18.04 container image as the starting point for our software.</p>

<p>2) So, now we want to create our own Docker image and install some software into it. How do we do so?</p>

<ul>
<li>Create a directory by doing:</li>
</ul>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir docker-tutorial</code></pre></div>
<ul>
<li>Change directory into the folder:</li>
</ul>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#111">cd</span> docker-tutorial</code></pre></div>
<ul>
<li>Start tracking the files in the folder with
<code>bash
git init
</code></li>
</ul>

<p>Create a file called Dockerfile in this directory, and put as the first line:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Dockerfile" data-lang="Dockerfile"><span style="color:#00a8c8">from</span><span style="color:#d88200"> ubuntu:18.04</span></code></pre></div>
<p>4) Now, we can start installing things inside the image. We do this by adding subsequent lines to the Dockerfile; a command to run a particular application is prefaced by &ldquo;RUN&rdquo;. If you&rsquo;re not familiar with Linux, and are primarily a Windows or Mac user, it may seem a little odd to install programmes using typed out commands, but it can be very powerful. For Ubuntu, there are basically two commands you <em>need</em> to know.</p>

<p>First, we&rsquo;ll need to get an up to date the list of Ubuntu packages which can be installed; note that this is almost always necessary. To do this, add:</p>

<p>The Ubuntu command for doing so is:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Dockerfile" data-lang="Dockerfile">apt-get update</code></pre></div>
<p>However, it is not a good idea to add this as an isolated command in Dockerfiles. We&rsquo;ll come to why later.</p>

<p>To install programmes in Ubuntu, you run the command:</p>

<pre><code>apt-get install NameOfApplication
</code></pre>

<p>To see what applications are available on Ubuntu 18.04, you can have a look <a href="here">https://packages.ubuntu.com/bionic/</a></p>

<div class="panel panel-info">
	<div class="panel-heading">Ubuntu Packaging</div>
	<div class="panel-body"><p>Ubuntu sees a release once every 6 months. However, it&rsquo;s not a good idea to upgrade that frequently. Most scientists using Ubuntu pick a Long Term Stable (LTS) release which is updated about every two years. With a LTS release, software you install through package repositories sees security updates, but not feature updates, and these are provided for three years after release. This means that you can rely on software built in that ecosystem continuing to work.</p>

<p>If you need updated versions of packages, you can still do so by either installing it manually, or using Personal Package Archives (PPAs) which are often provided by software authors.</p>
</div>
	
</div>


<p>First of all, we&rsquo;re just going to install Python 3. The <a href="https://packages.ubuntu.com/bionic/python/python3">package name</a> for this is just &lsquo;python3&rsquo;</p>

<p>To do this, add the following line to your Dockerfile</p>

<pre><code>RUN apt-get update &amp;&amp; apt-get install -y python3
</code></pre>

<p>Breaking this down, we&rsquo;ve just put the two commands together - the &lsquo;&amp;&amp;&rsquo; just runs the two commands as a single command, in order. Note that we&rsquo;ve here added a flag - &lsquo;-y&rsquo; to the install. This just means &lsquo;yes&rsquo; - if we try to install without this flag, the programme apt-get would expect us to confirm that we want to install the software, but the build of the image would fail because we&rsquo;re not in an interactive terminal during the container build process.</p>

<p>Now, you have a script which tells Docker to build a container which:
* Is based on Ubuntu 18.04. You could change this to another Linux distribution if you wanted, such as CentOS.
* Contains Python 3.</p>

<p>This is the general principle of containers - you build them up in steps until they have everything you need to run real applications.</p>

<p>Now, we can tell Docker to run a default command when the container is launched. We do this using a slightly different syntax - instead of using RUN, we set a programme using the &lsquo;CMD&rsquo; command.</p>

<pre><code>CMD /bin/bash
</code></pre>

<p>This just tells Docker to launch the Bash shell. From this, we can launch all of the programmes installed into the container. Alternatively, we could just as easily write:</p>

<pre><code>CMD /usr/local/python3
</code></pre>

<div class="panel panel-warning">
	<div class="panel-heading">CMD Warning</div>
	<div class="panel-body"><p>If you specify multiple commands in a Dockerfile with CMD, then all but the last are ignored!</p>
</div>
	
</div>


<p>Use the &lsquo;/bin/bash&rsquo; line in your Dockerfile.</p>

<p>7) Now let&rsquo;s actually build the container image from the script file. We do this using the following command - replace &ldquo;YOURUSERNAME&rdquo; with your username for the account we created with Dockerhub earlier.</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Bash" data-lang="Bash">docker build . -t myimage</code></pre></div>
<p>Breaking this command down:</p>

<ul>
<li><p>Docker is the application.</p></li>

<li><p>We&rsquo;re running Docker&rsquo;s &lsquo;build&rsquo; command</p></li>

<li><p>&rdquo;.&rdquo; refers to the file location - it&rsquo;s saying &ldquo;build the Dockerfile in this folder&rdquo;</p></li>

<li><p>-t myimage - if you&rsquo;re not familiar with Linux, adding a dash is a common way of signalling how to pass information to a command. Here, &ldquo;-t&rdquo; just means build the image with the tag myimage</p></li>
</ul>

<div class="panel panel-warning">
	<div class="panel-heading">CMD Warning</div>
	<div class="panel-body"><p>If you ever need help about a particular command, you can add the &lsquo;&ndash;help&rsquo; flag which gives you a bit more information. For example,
if we wanted to see what all of the Docker &lsquo;build&rsquo; options were, we can run:</p>

<pre><code>docker build --help
</code></pre>

<p>and you get a long list of flags and what they mean.</p>
</div>
	
</div>


<h3 id="more-concepts">More concepts</h3>

<p>Every time you add another command to the script, you create a new <em>layer</em>.
A layer is the essentially just a list of differences between the previous command and the present one. Your container image is built up of multiple layers. If you want to add a new command, you don&rsquo;t have to rebuild completely from scratch - Docker is clever enough to start from the <em>last common layer</em>. These layers do take up storage space, however.</p>

<p>That means though, if you change the programmes installed with apt-get on the second line of the script, all subsequent steps must be repeated, because Docker can&rsquo;t work out if subsequent steps are independent or not of each other.</p>

<div class="panel panel-warning">
	<div class="panel-heading">Looking back&hellip;</div>
	<div class="panel-body"><p>Earlier we had to specify <code>apt-get update</code> and <code>apt-get install</code> on a single line in our Dockerfile. This is due to the layers; if you try to modify a Dockerfile a few hours or days after creating it, some software may fail to install because Ubuntu sees frequent updates, and the apt package caches stored in the Dockerfile would be out of date. By always prefacing <code>apt-get install</code> with <code>apt-get update</code> we avoid having to worry about this.</p>
</div>
	
</div>


<p>7) Let&rsquo;s launch a container, and try and run some software.</p>

<p>We can do this in two ways - similar but quite different.</p>

<p>1) Start a container from the image interactively, and launch the programme:</p>

<p>To run interactively, we must add the &ldquo;-i -t&rdquo; flag. If we don&rsquo;t do this, the programme will launch, but will freeze!</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker run -i -t myimage bash</code></pre></div>
<p>Then, just run</p>

<pre><code>python3
</code></pre>

<p>to launch the Python interpreter.</p>

<p>2) To create a container from the image, and give it the name &lsquo;mytest&rsquo;</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker create --name mytest YOURUSERNAME/myimage</code></pre></div>
<ul>
<li>Then, start the container:</li>
</ul>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker start --name mytest</code></pre></div>
<ul>
<li>Then run a command in that container:</li>
</ul>

<p>Often, we want to install programmes in the container in order to manage dependencies, but we need to have them act on files stored on the host computer itself. This can easily be achieved by mounting folders into the container, so that they are visible inside it. The syntax for this is:</p>

<pre><code>docker run -it -v FOLDER_ON_HOST:FOLDER_IN_CONTAINER myimage
</code></pre>

<p>A really common use case is to mount the current directory inside the container. Normally we make the directory inside the container the default working directory for that container. You can do this by adding the following line to your Dockerfile:</p>

<pre><code>WORKDIR /app
</code></pre>

<p>If you&rsquo;re using Linux, we can then mount the current directory on the host system to this folder with:</p>

<pre><code>docker run -it -v $(pwd):/app
</code></pre>

<p>On Windows this is slightly different:</p>

<pre><code>docker run -it -v %cd%:/app
</code></pre>

<p>Another common use case is to open make a port from the container visible on the host system.</p>

<div class="panel panel-info">
	<div class="panel-heading">What is a port?</div>
	<div class="panel-body"><p>Ports are used to pass messages from one application to another. They are denoted by numbers, and there are two types:</p>

<ul>
<li>Transmission Control Protocol (TCP) - Messages sent from one application to another in order. If they arrive in the wrong order they are unjumbled by the reciever and if some are missing because of network issues, the receiver lets the sender know and they are resent. Think of it a bit like having a conversation.</li>
<li>UDP - Messages sent from one application to another but no acknowledgemnt from the reciever. Think of it a bit like one application shouting at another.</li>
</ul>

<p>Ports can be <em>forwarded</em> - think of this like rerouting your post from one address to another.</p>
</div>
	
</div>


<p>To open a TCP port when running a container you can do it via the command:</p>

<pre><code>docker run -it -p 4000:8000 myimage
</code></pre>

<p>Here, 4000 is the port on the host machine, and 8000 is the port inside the container which is being forwarded.</p>

<p>Just to prove this working, create a new file called &lsquo;index.html&rsquo; in your folder with the following contents:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#111">&lt;</span><span style="color:#f92672">html</span><span style="color:#111">&gt;</span>
<span style="color:#111">&lt;</span><span style="color:#f92672">head</span><span style="color:#111">&gt;</span>
  Testing out Port Forwarding with Docker
<span style="color:#111">&lt;/</span><span style="color:#f92672">head</span><span style="color:#111">&gt;</span>
<span style="color:#111">&lt;</span><span style="color:#f92672">body</span><span style="color:#111">&gt;</span>
Here is some text in a web page.
<span style="color:#111">&lt;/</span><span style="color:#f92672">body</span><span style="color:#111">&gt;</span>
<span style="color:#111">&lt;/</span><span style="color:#f92672">html</span><span style="color:#111">&gt;</span></code></pre></div>
<p>Launch the docker container with the following:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Linux and Mac
</span><span style="color:#75715e"></span>docker run -it -p <span style="color:#ae81ff">4000</span>:8000 -v <span style="color:#00a8c8">$(</span><span style="color:#111">pwd</span><span style="color:#00a8c8">)</span>:/app myimage python3 -m http.server
<span style="color:#75715e"># Windows
</span><span style="color:#75715e"></span>docker run -it -p <span style="color:#ae81ff">4000</span>:8000 -v %cd%:/app myimage python3 -m http.server</code></pre></div>
<p>Now, go to the URL localhost:4000 and you should see the webpage!</p>

<div class="panel panel-info">
	<div class="panel-heading">UDP Forwarding</div>
	<div class="panel-body"><p>It&rsquo;s not likely you&rsquo;ll have to use UDP ports very much, but for completeness, the syntax you would use to forward a UDP port is:
docker run -it -p 4000:8000/udp</p>
</div>
	
</div>



    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/containers/tutorial1/" title="Setting up the Software"> <i class="fa fa-chevron-left"></i><label>Setting up the Software</label></a>
    <a class="nav nav-next" href="/containers/tutorial3/" title="Saving and Sharing Images" style="margin-right: 0px;"><label>Saving and Sharing Images</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

    
    <div class="date">
        <i class='fa fa-calendar'></i> Last update on 26/10/2018
    </div>
    

    
    <div class="github-link">
      <a href="https://github.com/vjeantet/hugo-theme-docdock/edit/master/exampleSite/content/containers/tutorial2.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
    
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>